<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>L‚ÄôAscenseur</title>

<style>
:root {
  --bg:#f6f7fb;
  --primary:#4f46e5;
  --danger:#dc2626;
  --card:#fff;
}

body {
  font-family: system-ui, sans-serif;
  background: var(--bg);
  margin:0;
  padding:16px 16px 90px;
}

h1,h2 {
  text-align:center;
  margin:12px 0;
}

.card {
  background:var(--card);
  border-radius:16px;
  padding:16px;
  margin:16px auto;
  max-width:1100px;
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}

button {
  background:var(--primary);
  color:#fff;
  border:none;
  padding:14px;
  border-radius:14px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  width:100%;
}

button.danger {
  background:var(--danger);
}

input {
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:12px;
  border:1px solid #d1d5db;
  text-align:center;
}

input.readonly {
  background:#f3f4f6;
  font-weight:700;
}

.dealer {
  color:var(--primary);
  font-weight:800;
}

/* ===== MOBILE PLAYER CARD ===== */
.player-card {
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:12px;
  margin-bottom:12px;
}

.player-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:700;
  margin-bottom:10px;
}

.player-inputs {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}

.player-total {
  margin-top:10px;
  text-align:center;
  font-weight:700;
}

/* ===== DESKTOP TABLE ===== */
table {
  width:100%;
  border-collapse:collapse;
}

th,td {
  padding:8px;
  text-align:center;
  border-bottom:1px solid #e5e7eb;
}

th {
  background:#eef2ff;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  table { display:none; }
}

@media (min-width: 769px) {
  .mobile { display:none; }
}

/* RESET BAR */
#resetBar {
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:white;
  padding:12px;
  box-shadow:0 -5px 20px rgba(0,0,0,.1);
}
</style>
</head>

<body>

<h1>üé¥ L‚ÄôAscenseur</h1>

<div class="card" id="setup">
  <h2>Nouvelle partie</h2>
  <input type="number" id="nbJoueurs" min="2" max="6" value="4">
  <br><br>
  <button onclick="setupNames()">Continuer</button>
</div>

<div id="names"></div>
<div id="game"></div>
<div id="recap"></div>

<div id="resetBar" style="display:none">
  <button class="danger" onclick="resetGame()">üîÑ R√©initialiser la partie</button>
</div>

<script>
let joueurs=[], scores=[], manches=[];
let paris=[], plis=[];
let manche=1, sens=1, dealerIndex=0;
let parisValides=false;
const maxCartes=5;

/* SETUP */
function setupNames(){
  const nb=+document.getElementById("nbJoueurs").value;
  document.getElementById("setup").style.display="none";
  let html=`<div class="card"><h2>Noms des joueurs</h2>`;
  for(let i=0;i<nb;i++){
    html+=`<input id="name${i}" placeholder="Joueur ${i+1}"><br><br>`;
  }
  html+=`<button onclick="startGame(${nb})">D√©marrer</button></div>`;
  document.getElementById("names").innerHTML=html;
}

function startGame(nb){
  joueurs=[];
  for(let i=0;i<nb;i++){
    joueurs.push(document.getElementById("name"+i).value || "Joueur "+(i+1));
  }
  document.getElementById("names").style.display="none";
  document.getElementById("resetBar").style.display="block";

  scores=Array(nb).fill(0);
  paris=Array(nb).fill(0);
  plis=Array(nb).fill(0);
  manches=[];
  manche=1; sens=1; dealerIndex=0; parisValides=false;
  renderGame();
}

/* GAME RENDER */
function renderGame(){
  let html=`<div class="card">
    <h2>Manche ${manche} carte(s)</h2>
    <p style="text-align:center">üÉè Dealer : <span class="dealer">${joueurs[dealerIndex]}</span></p>
    <div class="mobile">`;

  joueurs.forEach((j,i)=>{
    html+=`
    <div class="player-card">
      <div class="player-header">
        <span>${j}${i===dealerIndex?" üÉè":""}</span>
      </div>
      <div class="player-inputs">
        <input type="number" min="0" max="${manche}" value="${paris[i]}"
          ${parisValides?"readonly class='readonly'":""}
          oninput="paris[${i}]=+this.value||0" placeholder="Pari">
        <input type="number" min="0" max="${manche}" value="${plis[i]}"
          ${!parisValides?"readonly class='readonly'":""}
          oninput="plis[${i}]=+this.value||0" placeholder="Plis">
      </div>
      <div class="player-total">Total : ${scores[i]}</div>
    </div>`;
  });

  html+=`</div><br>`;
  html+= !parisValides
    ? `<button onclick="validerParis()">Valider les paris</button>`
    : `<button onclick="validerManche()">Valider la manche</button>`;
  html+=`</div>`;

  document.getElementById("game").innerHTML=html;
}

/* LOGIC */
function validerParis(){
  let somme=0;
  joueurs.forEach((_,i)=>{ if(i!==dealerIndex) somme+=paris[i]; });
  if(somme+paris[dealerIndex]===manche){
    alert("‚ùå Tu peux paaaaaaaaas !");
    return;
  }
  parisValides=true;
  renderGame();
}

function validerManche(){
  joueurs.forEach((_,i)=>{
    scores[i]+= paris[i]===plis[i]
      ? 10*(plis[i]+1)
      : -10*Math.abs(paris[i]-plis[i]);
  });

  paris.fill(0); plis.fill(0);
  parisValides=false;
  dealerIndex=(dealerIndex+1)%joueurs.length;
  if(manche===maxCartes) sens=-1;
  manche+=sens;
  if(manche===0){ alert("üéâ Partie termin√©e !"); return; }
  renderGame();
}

function resetGame(){
  if(confirm("R√©initialiser la partie ?")) location.reload();
}
</script>

</body>
</html>
