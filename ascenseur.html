<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Lâ€™Ascenseur</title>

<style>
:root{
 --bg:#f6f7fb;
 --primary:#4f46e5;
 --danger:#dc2626;
 --card:#fff;
}

body{
 margin:0;
 font-family:system-ui,sans-serif;
 background:var(--bg);
 padding:16px 16px 120px;
}

h1,h2{text-align:center}

.card{
 background:var(--card);
 border-radius:16px;
 padding:16px;
 margin:16px auto;
 max-width:900px;
 box-shadow:0 10px 25px rgba(0,0,0,.1);
}

button{
 background:var(--primary);
 color:#fff;
 border:none;
 padding:12px;
 border-radius:14px;
 font-size:15px;
 font-weight:700;
}

button.secondary{
 background:#e5e7eb;
 color:#111;
}

input{
 width:75%;
 padding:10px;
 border-radius:12px;
 border:1px solid #ccc;
 text-align:center;
}

.readonly{background:#f3f4f6;font-weight:700}

.player-card{
 border:1px solid #e5e7eb;
 border-radius:14px;
 padding:12px;
 margin-bottom:12px;
}

.player-header{text-align:center;font-weight:700}

.player-inputs{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:8px;
 justify-items:center;
}

.player-total{text-align:center;font-weight:700;margin-top:6px}

#actionBar{
 position:fixed;
 bottom:0;left:0;right:0;
 background:#fff;
 padding:10px;
 box-shadow:0 -5px 20px rgba(0,0,0,.15);
 display:flex;
 gap:10px;
}

#actionBar .main{flex:1}

#dealerAlert{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.6);
 display:flex;
 align-items:center;
 justify-content:center;
 z-index:99;
 animation:fadeIn .3s;
}

.alert-card{
 background:white;
 padding:30px;
 border-radius:20px;
 font-size:28px;
 font-weight:900;
 color:var(--danger);
 animation:shake .5s infinite;
}

@keyframes shake{
 0%{transform:rotate(-2deg)}
 50%{transform:rotate(2deg)}
 100%{transform:rotate(-2deg)}
}

@keyframes fadeIn{from{opacity:0}to{opacity:1}}

.rank{
 display:flex;
 justify-content:space-between;
 padding:10px;
 border-bottom:1px solid #eee;
 font-weight:700;
}
</style>
</head>

<body>

<h1>ğŸ´ Lâ€™Ascenseur</h1>

<div class="card" id="setup">
 <h2>Nombre de joueurs</h2>
 <div style="display:flex;justify-content:center;gap:16px">
  <button onclick="chg(-1)">âˆ’</button>
  <span id="nb" style="font-size:22px;font-weight:800">4</span>
  <button onclick="chg(1)">+</button>
 </div>
 <br>
 <button style="width:100%" onclick="names()">Continuer</button>
</div>

<div id="names"></div>
<div id="game"></div>
<div id="end"></div>

<div id="actionBar" style="display:none">
 <button class="main" id="mainBtn" onclick="action()"></button>
 <button class="secondary" onclick="reset()">â™»ï¸</button>
</div>

<script>
let nbJ=4, joueurs=[], scores=[], paris=[], plis=[];
let totalParis=[], manche=1, sens=1, dealer=0, parisOK=false;
const max=5;

function chg(d){nbJ=Math.min(6,Math.max(2,nbJ+d));nb.innerText=nbJ}

function names(){
 setup.style.display="none";
 let h=`<div class="card"><h2>Noms</h2>`;
 for(let i=0;i<nbJ;i++)h+=`<input id="n${i}" placeholder="Joueur ${i+1}"><br><br>`;
 h+=`<button style="width:100%" onclick="start()">DÃ©marrer</button></div>`;
 namesDiv.innerHTML=h;
}
const namesDiv=document.getElementById("names");

function start(){
 for(let i=0;i<nbJ;i++)joueurs.push(n${i}.value||`Joueur ${i+1}`);
 scores=Array(nbJ).fill(0);
 totalParis=Array(nbJ).fill(0);
 paris=Array(nbJ).fill(0);
 plis=Array(nbJ).fill(0);
 namesDiv.style.display="none";
 actionBar.style.display="flex";
 draw();
}

function draw(){
 let h=`<div class="card"><h2>Manche ${manche}</h2><p style="text-align:center">ğŸƒ Dealer : <b>${joueurs[dealer]}</b></p>`;
 joueurs.forEach((j,i)=>{
 h+=`<div class="player-card">
 <div class="player-header">${j}${i===dealer?" ğŸƒ":""}</div>
 <div class="player-inputs">
  <input type="number" min="0" max="${manche}" value="${paris[i]}" ${parisOK?"readonly class='readonly'":""} oninput="paris[${i}]=+this.value||0">
  <input type="number" min="0" max="${manche}" value="${plis[i]}" ${!parisOK?"readonly class='readonly'":""} oninput="plis[${i}]=+this.value||0">
 </div>
 <div class="player-total">Score : ${scores[i]}</div>
 </div>`;
 });
 game.innerHTML=h+"</div>";
 mainBtn.innerText=parisOK?"Manche suivante":"Valider les paris";
}

function action(){parisOK?next():checkParis()}

function checkParis(){
 let sum=0;
 joueurs.forEach((_,i)=>{sum+=paris[i];totalParis[i]+=paris[i]});
 if(sum===manche){
  document.body.insertAdjacentHTML("beforeend",
   `<div id="dealerAlert"><div class="alert-card">TU PEUX PAAAAAAS ğŸ˜ˆ</div></div>`);
  setTimeout(()=>dealerAlert.remove(),1500);
  return;
 }
 parisOK=true; draw();
}

function next(){
 joueurs.forEach((_,i)=>{
  scores[i]+=paris[i]===plis[i]?10*(plis[i]+1):-10*Math.abs(paris[i]-plis[i]);
 });
 paris.fill(0);plis.fill(0);parisOK=false;
 dealer=(dealer+1)%joueurs.length;
 if(manche===max)sens=-1;
 manche+=sens;
 if(manche===0)return endGame();
 draw();
}

function endGame(){
 actionBar.style.display="none";
 let ranked=[...joueurs.keys()].sort((a,b)=>scores[b]-scores[a]);
 let h=`<div class="card"><h2>ğŸ† Classement final</h2>`;
 ranked.forEach((i,r)=>{
  h+=`<div class="rank">
   <span>${["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"][r]||"ğŸ´"} ${joueurs[i]}</span>
   <span>${scores[i]} pts | Paris : ${totalParis[i]}</span>
  </div>`;
 });
 end.innerHTML=h+"</div>";
}

function reset(){if(confirm("Nouvelle partie ?"))location.reload()}
</script>

</body>
</html>
